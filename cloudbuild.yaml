steps:
  - name: 'gcr.io/cloud-builders/npm'
    args: ['install']

  - name: 'gcr.io/cloud-builders/npm'
    args: ['run', 'lint']

  - name: 'gcr.io/cloud-builders/npm'
    args: ['run', 'build:staging']

  - name: 'gcr.io/$PROJECT_ID/firebase'
    args:
      [
        'deploy',
        '--project',
        'learning-centers-staging',
        '--token',
        '$$FIREBASE_TOKEN',
      ]
    secretEnv: ['FIREBASE_TOKEN']

secrets:
  - kmsKeyName: 'projects/learning-centers-staging/locations/global/keyRings/cloudbuilder/cryptoKeys/firebase-token'
    secretEnv:
      FIREBASE_TOKEN: 'CiQA56ywkO0EgJOP91RBmCxHq+nqavuc/Z8Ey0jUuq0yDjxoWgESawBWE9VymSCU4FESAqfuKH4BePSNDaa8uFajQahrNgYXNQkqQ6hB4WGgRqW1nKsU/mAEdZFYpFbbV2gTF3Bs5NsYpz93K0zcjor1Z0265E7+mcwDHCfgtP3QvAGNFWbc0fizilKw0tK2ICF/'
